<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Absen AF PRODUCTIONS - Login dengan Password</title>
  <style>
    :root {
      --primary: #0d6efd;
      --success: #198754;
      --warning: #ffc107;
      --danger: #dc3545;
      --gray: #f8f9fa;
      --dark: #212529;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: var(--gray);
      color: var(--dark);
    }

    header {
      background-color: var(--primary);
      color: white;
      text-align: center;
      padding: 1.5rem;
      font-size: 1.8rem;
      font-weight: bold;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .marquee-container {
      overflow: hidden;
      background: var(--warning);
      color: #212529;
      padding: 0.5rem 1rem;
      font-weight: 500;
    }

    .marquee {
      display: inline-block;
      white-space: nowrap;
      animation: scroll-left 15s linear infinite;
    }

    @keyframes scroll-left {
      0% {
        transform: translateX(100%);
      }
      100% {
        transform: translateX(-100%);
      }
    }

    .container {
      max-width: 600px;
      margin: 2rem auto;
      background: white;
      padding: 2rem;
      border-radius: 10px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.08);
    }

    input, button, textarea {
      width: 100%;
      margin-top: 1rem;
      padding: 0.75rem;
      font-size: 1rem;
      border: 1px solid #ccc;
      border-radius: 6px;
      transition: 0.3s;
    }

    input:focus, textarea:focus {
      border-color: var(--primary);
      outline: none;
    }

    button {
      background-color: var(--primary);
      color: white;
      border: none;
      cursor: pointer;
      font-weight: bold;
    }

    button:hover {
      background-color: #0b5ed7;
    }

    .hidden {
      display: none;
    }

    .riwayat, .chat {
      margin-top: 2rem;
    }

    .riwayat h3, .chat h3 {
      margin-bottom: 1rem;
      color: var(--primary);
    }

    .riwayat-item {
      background: var(--gray);
      padding: 0.75rem;
      margin-bottom: 0.5rem;
      border-left: 4px solid var(--primary);
      border-radius: 4px;
      font-size: 0.95rem;
    }

    .chat textarea {
      min-height: 100px;
      resize: vertical;
    }

    video {
      max-width: 100%;
      margin-top: 1rem;
      border-radius: 10px;
      background: black;
    }

    .datetime {
      margin-top: 1rem;
      font-weight: bold;
      font-size: 1.1rem;
      text-align: center;
      color: var(--primary);
    }

    @media (max-width: 600px) {
      .container {
        margin: 1rem;
        padding: 1.5rem;
      }

      header {
        font-size: 1.5rem;
      }
    }
  </style>
</head>
<body>

  <header>ABSEN AF PRODUCTIONS</header>
  <div class="marquee-container">
    <div class="marquee">üì¢ Semangat bekerja! Jangan lupa absen masuk & pulang tepat waktu üí™</div>
  </div>

  <!-- Halaman Login -->
  <div class="container" id="loginPage">
    <h2>Login Absen</h2>
    <input type="text" id="username" placeholder="üÜî Masukkan No Induk" required />
    <input type="password" id="password" placeholder="üîí Masukkan Password" required />
    <button id="btnLogin">üîì Login</button>
  </div>

  <!-- Halaman Absen -->
  <div class="container hidden" id="absenPage">

    <div class="datetime" id="liveDateTime"></div>

    <form id="absenForm">
      <input type="text" id="noInduk" readonly />
      <button type="button" id="btnMasuk">‚úÖ Absen Masuk</button>
      <button type="button" id="btnPulang" style="background-color: var(--danger);">‚èπÔ∏è Absen Pulang</button>
    </form>

    <video id="video" autoplay playsinline></video>

    <div class="riwayat">
      <h3>üìã Riwayat Absen</h3>
      <div id="riwayatList">Memuat data...</div>
    </div>

    <div class="chat">
      <h3>üí¨ Kirim Pesan ke IT</h3>
      <textarea id="chatPesan" placeholder="Tulis kendala atau pesan Anda di sini..."></textarea>
      <button id="kirimChat">üì® Kirim</button>
    </div>

    <button id="btnLogout" style="margin-top:1.5rem; background:#dc3545;">üö™ Logout</button>
  </div>

  <script>
    // Data user contoh (username:password)
    const users = {
      "12345": "password123",
      "67890": "admin2025",
      "alice": "qwerty",
      "bob": "123456"
    };

    let statusAbsen = { masuk: false, pulang: false };
    let currentUser = "";

    const loginPage = document.getElementById("loginPage");
    const absenPage = document.getElementById("absenPage");
    const usernameInput = document.getElementById("username");
    const passwordInput = document.getElementById("password");
    const noIndukField = document.getElementById("noInduk");
    const liveDateTime = document.getElementById("liveDateTime");
    const video = document.getElementById("video");
    const riwayatList = document.getElementById("riwayatList");
    const chatPesan = document.getElementById("chatPesan");

    // Login dengan validasi user & password
    document.getElementById("btnLogin").addEventListener("click", () => {
      const username = usernameInput.value.trim();
      const password = passwordInput.value.trim();

      if (!username || !password) {
        return alert("Mohon isi Username dan Password.");
      }

      if (users[username] && users[username] === password) {
        currentUser = username;
        statusAbsen = { masuk: false, pulang: false };
        noIndukField.value = currentUser;

        usernameInput.value = "";
        passwordInput.value = "";

        loginPage.classList.add("hidden");
        absenPage.classList.remove("hidden");

        startDateTime();
        startCamera();
        loadRiwayat();
      } else {
        alert("Username atau Password salah.");
      }
    });

    // Logout
    document.getElementById("btnLogout").addEventListener("click", () => {
      currentUser = "";
      statusAbsen = { masuk: false, pulang: false };
      usernameInput.value = "";
      passwordInput.value = "";
      chatPesan.value = "";
      riwayatList.innerHTML = "Memuat data...";
      stopCamera();

      absenPage.classList.add("hidden");
      loginPage.classList.remove("hidden");
    });

    // Live Date & Time
    function startDateTime() {
      function update() {
        const now = new Date();
        liveDateTime.textContent = now.toLocaleString("id-ID", {
          weekday: "long", year: "numeric", month: "long", day: "numeric",
          hour: "2-digit", minute: "2-digit", second: "2-digit"
        });
      }
      update();
      setInterval(update, 1000);
    }

    // Kamera depan
    let stream = null;
    function startCamera() {
      if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
        navigator.mediaDevices.getUserMedia({ video: { facingMode: "user" } })
          .then(s => {
            stream = s;
            video.srcObject = stream;
          })
          .catch(() => {
            alert("Tidak dapat mengakses kamera.");
          });
      } else {
        alert("Browser tidak mendukung akses kamera.");
      }
    }
    function stopCamera() {
      if (stream) {
        stream.getTracks().forEach(track => track.stop());
      }
    }

    // Simulasi riwayat absen
    let riwayatData = [];

    function loadRiwayat() {
      if (riwayatData.length === 0) {
        riwayatList.innerHTML = "Belum ada data absensi.";
      } else {
        renderRiwayat();
      }
    }

    function renderRiwayat() {
      riwayatList.innerHTML = "";
      riwayatData.forEach(r => {
        riwayatList.innerHTML += `<div class="riwayat-item">[${new Date(r.waktu).toLocaleString()}] - ${r.tipe.toUpperCase()} - User: ${r.user}</div>`;
      });
    }

    // Absen masuk/pulang (simulasi tanpa server)
    document.getElementById("btnMasuk").addEventListener("click", () => {
      if (statusAbsen.masuk) return alert("Kamu sudah absen masuk.");
      const waktu = new Date();
      riwayatData.push({ waktu: waktu.toISOString(), tipe: "masuk", user: currentUser });
      statusAbsen.masuk = true;
      renderRiwayat();
      alert("‚úÖ Absen masuk berhasil. Semangat bekerja!");
    });

    document.getElementById("btnPulang").addEventListener("click", () => {
      if (!statusAbsen.masuk) return alert("Kamu belum absen masuk.");
      if (statusAbsen.pulang) return alert("Kamu sudah absen pulang.");
      const waktu = new Date();
      riwayatData.push({ waktu: waktu.toISOString(), tipe: "pulang", user: currentUser });
      statusAbsen.pulang = true;
      renderRiwayat();
      alert("‚úÖ Absen pulang berhasil. Hati-hati di jalan!");
    });

    // Kirim pesan ke IT (simulasi)
    document.getElementById("kirimChat").addEventListener("click", () => {
      const pesan = chatPesan.value.trim();
      if (!pesan) return alert("Isi pesan terlebih dahulu.");
      alert("üì® Pesan berhasil dikirim ke IT (simulasi).");
      chatPesan.value = "";
    });
  </script>

</body>
</html>
